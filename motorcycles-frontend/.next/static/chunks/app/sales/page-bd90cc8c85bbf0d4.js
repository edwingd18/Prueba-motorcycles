(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[117],{3571:(e,t,a)=>{"use strict";a.d(t,{A:()=>i});var s=a(5155),l=a(2115),r=a(4873);let n=(0,l.forwardRef)((e,t)=>{let{label:a,error:l,className:n,children:i,...c}=e;return(0,s.jsxs)("div",{className:"space-y-1",children:[a&&(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:a}),(0,s.jsx)("select",{ref:t,className:(0,r.cn)("w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900 bg-white",l&&"border-red-500 focus:ring-red-500",n),...c,children:i}),l&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:l})]})});n.displayName="Select";let i=n},4816:(e,t,a)=>{Promise.resolve().then(a.bind(a,9790))},9790:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>C});var s=a(5155),l=a(2115),r=a(9946);let n=(0,r.A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),i=(0,r.A)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var c=a(3717),d=a(2525),o=a(4616),m=a(722),x=a(9812),u=a(9960),h=a(1175),y=a(1876),p=a(3571);function g(e){var t,a;let{isOpen:r,onClose:n,onSuccess:i,sale:c}=e,[x,g]=(0,l.useState)({saleNumber:"",customer:null,employee:null,saleDate:new Date().toISOString().split("T")[0],status:"PENDING",total:0,paymentMethod:"CASH"}),[j,N]=(0,l.useState)([{motorcycle:null,quantity:1,discount:0}]),[v,f]=(0,l.useState)([]),[b,w]=(0,l.useState)([]),[A,C]=(0,l.useState)([]),[D,E]=(0,l.useState)(!1),[k,S]=(0,l.useState)(!0),[M,I]=(0,l.useState)({});(0,l.useEffect)(()=>{r&&q()},[r]),(0,l.useEffect)(()=>{c?(g({saleNumber:c.saleNumber,customer:c.customer,employee:c.employee,saleDate:c.saleDate.split("T")[0],status:c.status,total:c.total,paymentMethod:c.paymentMethod||"CASH"}),c.details&&c.details.length>0&&N(c.details.map(e=>({motorcycle:e.motorcycle,quantity:e.quantity,discount:e.discount||0})))):(g({saleNumber:"SALE-".concat(Date.now()),customer:null,employee:null,saleDate:new Date().toISOString().split("T")[0],status:"PENDING",total:0,paymentMethod:"CASH"}),N([{motorcycle:null,quantity:1,discount:0}])),I({})},[c,r]);let q=async()=>{try{var e,t,a;S(!0);let[s,l,r]=await Promise.all([m.mJ.getAll(),m.yD.getAll(),m.Di.getAll()]),n=Array.isArray(s.data)?s.data:(null==(e=s.data)?void 0:e.data)||[],i=Array.isArray(l.data)?l.data:(null==(t=l.data)?void 0:t.data)||[],c=Array.isArray(r.data)?r.data:(null==(a=r.data)?void 0:a.data)||[];f(n),w(i),C(c)}catch(e){console.error("Error fetching data:",e)}finally{S(!1)}};(0,l.useEffect)(()=>{let e=j.reduce((e,t)=>t.motorcycle?e+(t.motorcycle.price*t.quantity-t.discount):e,0);g(t=>({...t,total:e}))},[j]);let P=async e=>{if(e.preventDefault(),(()=>{let e={};if(x.saleNumber.trim()?x.saleNumber.length<3&&(e.saleNumber="El n\xfamero de venta debe tener al menos 3 caracteres"):e.saleNumber="El n\xfamero de venta es requerido",x.customer||(e.customer="Selecciona un cliente"),x.employee||(e.employee="Selecciona un empleado"),x.saleDate){let t=new Date(x.saleDate),a=new Date,s=new Date;s.setDate(a.getDate()+30),t>s&&(e.saleDate="La fecha no puede ser m\xe1s de 30 d\xedas en el futuro")}else e.saleDate="La fecha es requerida";return 0!==j.length&&j.some(e=>e.motorcycle)?j.forEach((t,a)=>{t.motorcycle&&(t.quantity<=0&&(e["detail_".concat(a,"_quantity")]="Cantidad debe ser mayor a 0 en el detalle ".concat(a+1)),t.discount<0&&(e["detail_".concat(a,"_discount")]="Descuento no puede ser negativo en el detalle ".concat(a+1)),t.discount>=t.motorcycle.price*t.quantity&&(e["detail_".concat(a,"_discount")]="Descuento no puede ser mayor o igual al precio total en el detalle ".concat(a+1)))}):e.details="Agrega al menos un detalle de venta",x.total<=0&&(e.total="El total debe ser mayor a 0"),I(e),0===Object.keys(e).length})()){E(!0);try{let e=j.filter(e=>null!==e.motorcycle).map(e=>({motorcycle:e.motorcycle,quantity:e.quantity,unitPrice:e.motorcycle.price,discount:e.discount,subtotal:e.motorcycle.price*e.quantity-e.discount})),t={saleNumber:x.saleNumber,customer:x.customer,employee:x.employee,saleDate:new Date(x.saleDate).toISOString(),status:x.status,total:x.total,paymentMethod:x.paymentMethod,details:e};console.log("Enviando datos de venta:",t),console.log("Detalles de venta:",e),c?await m.J2.update(c.id,t):await m.J2.create(t),i(),n()}catch(e){console.error("Error saving sale:",e)}finally{E(!1)}}},T=(e,t,a)=>{let s=[...j];s[e]={...s[e],[t]:a},N(s)};return k?(0,s.jsx)(h.A,{isOpen:r,onClose:n,title:c?"Editar Venta":"Nueva Venta",size:"xl",children:(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-blue-600 mb-4"}),(0,s.jsx)("span",{className:"text-gray-600 font-medium",children:"Cargando datos..."})]})}):(0,s.jsx)(h.A,{isOpen:r,onClose:n,title:c?"Editar Venta":"Nueva Venta",size:"xl",children:(0,s.jsxs)("form",{onSubmit:P,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsx)(y.A,{label:"N\xfamero de Venta",value:x.saleNumber,onChange:e=>g(t=>({...t,saleNumber:e.target.value})),error:M.saleNumber,placeholder:"SALE-0001"}),(0,s.jsx)(y.A,{label:"Fecha de Venta",type:"date",value:x.saleDate,onChange:e=>g(t=>({...t,saleDate:e.target.value})),error:M.saleDate})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)(p.A,{label:"Cliente",value:(null==(t=x.customer)?void 0:t.id)||"",onChange:e=>{let t=v.find(t=>t.id===parseInt(e.target.value))||null;g(e=>({...e,customer:t}))},error:M.customer,children:[(0,s.jsx)("option",{value:"",children:"Selecciona un cliente"}),v.map(e=>(0,s.jsxs)("option",{value:e.id,children:[e.firstName," ",e.lastName," - ",e.email]},e.id))]}),(0,s.jsxs)(p.A,{label:"Empleado",value:(null==(a=x.employee)?void 0:a.id)||"",onChange:e=>{let t=b.find(t=>t.id===parseInt(e.target.value))||null;g(e=>({...e,employee:t}))},error:M.employee,children:[(0,s.jsx)("option",{value:"",children:"Selecciona un empleado"}),b.map(e=>(0,s.jsxs)("option",{value:e.id,children:[e.firstName," ",e.lastName," ",e.position&&"(".concat(e.position,")")]},e.id))]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)(p.A,{label:"Estado",value:x.status,onChange:e=>g(t=>({...t,status:e.target.value})),children:[(0,s.jsx)("option",{value:"PENDING",children:"Pendiente"}),(0,s.jsx)("option",{value:"COMPLETED",children:"Completada"}),(0,s.jsx)("option",{value:"CANCELLED",children:"Cancelada"})]}),(0,s.jsxs)(p.A,{label:"M\xe9todo de Pago",value:x.paymentMethod,onChange:e=>g(t=>({...t,paymentMethod:e.target.value})),children:[(0,s.jsx)("option",{value:"CASH",children:"Efectivo"}),(0,s.jsx)("option",{value:"CREDIT_CARD",children:"Tarjeta de Cr\xe9dito"}),(0,s.jsx)("option",{value:"DEBIT_CARD",children:"Tarjeta de D\xe9bito"}),(0,s.jsx)("option",{value:"BANK_TRANSFER",children:"Transferencia Bancaria"}),(0,s.jsx)("option",{value:"FINANCING",children:"Financiamiento"})]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h3",{className:"text-lg font-medium",children:"Detalles de la Venta"}),(0,s.jsxs)(u.A,{type:"button",variant:"secondary",size:"sm",onClick:()=>{N([...j,{motorcycle:null,quantity:1,discount:0}])},children:[(0,s.jsx)(o.A,{className:"h-4 w-4 mr-1"}),"Agregar Detalle"]})]}),M.details&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:M.details}),j.map((e,t)=>{var a;return(0,s.jsxs)("div",{className:"p-4 border border-gray-200 rounded-lg space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("h4",{className:"text-sm font-medium text-gray-700",children:["Detalle ",t+1]}),j.length>1&&(0,s.jsx)(u.A,{type:"button",variant:"ghost",size:"sm",onClick:()=>{j.length>1&&N(j.filter((e,a)=>a!==t))},children:(0,s.jsx)(d.A,{className:"h-4 w-4 text-red-500"})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,s.jsx)("div",{className:"md:col-span-2",children:(0,s.jsxs)(p.A,{label:"Motocicleta",value:(null==(a=e.motorcycle)?void 0:a.id)||"",onChange:e=>{T(t,"motorcycle",A.find(t=>t.id===parseInt(e.target.value))||null)},children:[(0,s.jsx)("option",{value:"",children:"Selecciona una motocicleta"}),A.map(e=>(0,s.jsxs)("option",{value:e.id,children:[e.brand," ",e.model," (",e.year,") - $",e.price]},e.id))]})}),(0,s.jsx)("div",{children:(0,s.jsx)(y.A,{label:"Cantidad",type:"number",min:"1",max:"100",value:e.quantity,onChange:e=>T(t,"quantity",parseInt(e.target.value)||1),placeholder:"Cantidad",error:M["detail_".concat(t,"_quantity")],required:!0})}),(0,s.jsx)("div",{children:(0,s.jsx)(y.A,{label:"Descuento ($)",type:"number",step:"0.01",min:"0",max:e.motorcycle?(e.motorcycle.price*e.quantity*.99).toString():void 0,value:e.discount,onChange:e=>T(t,"discount",parseFloat(e.target.value)||0),placeholder:"0.00",error:M["detail_".concat(t,"_discount")]})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Precio Unitario"}),(0,s.jsx)("input",{type:"text",value:e.motorcycle?"$".concat(e.motorcycle.price.toFixed(2)):"-",disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-500"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Subtotal"}),(0,s.jsx)("input",{type:"text",value:e.motorcycle?"$".concat((e.motorcycle.price*e.quantity-e.discount).toFixed(2)):"-",disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-500"})]})]})]},t)})]}),(0,s.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg",children:(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("span",{className:"text-lg font-medium text-gray-700",children:"Total:"}),(0,s.jsxs)("span",{className:"text-2xl font-bold text-green-600",children:["$",x.total.toFixed(2)]})]})}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 sm:justify-end pt-6 border-t border-gray-200 -mx-4 sm:-mx-6 px-4 sm:px-6 mt-8",children:[(0,s.jsx)(u.A,{type:"button",variant:"secondary",onClick:n,className:"order-2 sm:order-1",children:"Cancelar"}),(0,s.jsxs)(u.A,{type:"submit",loading:D,className:"order-1 sm:order-2",children:[c?"Actualizar":"Crear"," Venta"]})]})]})})}var j=a(4873);let N=(0,r.A)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]),v=(0,r.A)("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),f=(0,r.A)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),b=(0,r.A)("briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);function w(e){var t,a,r,i,c,d,o;let{isOpen:x,onClose:u,sale:y}=e,[p,g]=(0,l.useState)(null),[w,A]=(0,l.useState)(!1);(0,l.useEffect)(()=>{x&&y&&C()},[x,y]);let C=async()=>{if(y){A(!0);try{let e=await m.J2.getByIdWithDetails(y.id);console.log("Sale details response:",e.data),g(e.data)}catch(e){console.error("Error fetching sale details:",e),g(y)}finally{A(!1)}}};if(!y)return null;let D=p||y;return(0,s.jsx)(h.A,{isOpen:x,onClose:u,title:"Venta ".concat(D.saleNumber),size:"lg",children:(0,s.jsxs)("div",{className:"space-y-6",children:[w&&(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-blue-600 mb-4"}),(0,s.jsx)("span",{className:"text-gray-600 font-medium",children:"Cargando detalles..."})]}),!w&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg p-5 shadow-sm",children:(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[(0,s.jsx)(N,{className:"h-5 w-5 text-blue-600 mr-2"}),"Informaci\xf3n General"]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(n,{className:"h-5 w-5 text-gray-400 mr-3"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Fecha de Venta"}),(0,s.jsx)("p",{className:"font-medium",children:(0,j.Y)(D.saleDate)})]})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(N,{className:"h-5 w-5 text-gray-400 mr-3"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Estado"}),(0,s.jsx)("div",{className:"mt-1",children:(d=D.status,(0,s.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat({COMPLETED:"bg-green-100 text-green-800",PENDING:"bg-yellow-100 text-yellow-800",CANCELLED:"bg-red-100 text-red-800"}[d]||"bg-gray-100 text-gray-800"),children:{COMPLETED:"Completada",PENDING:"Pendiente",CANCELLED:"Cancelada"}[d]||d}))})]})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(v,{className:"h-5 w-5 text-gray-400 mr-3"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"M\xe9todo de Pago"}),(0,s.jsx)("p",{className:"font-medium",children:{CASH:"Efectivo",CREDIT_CARD:"Tarjeta de Cr\xe9dito",DEBIT_CARD:"Tarjeta de D\xe9bito",BANK_TRANSFER:"Transferencia Bancaria",FINANCING:"Financiamiento"}[o=D.paymentMethod||""]||o})]})]})]})]})}),(0,s.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg p-5 shadow-sm",children:(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[(0,s.jsx)(f,{className:"h-5 w-5 text-green-600 mr-2"}),"Personas Involucradas"]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)(f,{className:"h-5 w-5 text-gray-400 mr-3 mt-0.5"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Cliente"}),(0,s.jsx)("p",{className:"font-medium",children:D.customer?"".concat(D.customer.firstName," ").concat(D.customer.lastName):"-"}),(null==(t=D.customer)?void 0:t.email)&&(0,s.jsx)("p",{className:"text-sm text-gray-500",children:D.customer.email}),(null==(a=D.customer)?void 0:a.phone)&&(0,s.jsx)("p",{className:"text-sm text-gray-500",children:D.customer.phone})]})]}),(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)(b,{className:"h-5 w-5 text-gray-400 mr-3 mt-0.5"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Empleado"}),(0,s.jsx)("p",{className:"font-medium",children:D.employee?"".concat(D.employee.firstName," ").concat(D.employee.lastName):"-"}),(null==(r=D.employee)?void 0:r.position)&&(0,s.jsx)("p",{className:"text-sm text-gray-500",children:D.employee.position}),(null==(i=D.employee)?void 0:i.email)&&(0,s.jsx)("p",{className:"text-sm text-gray-500",children:D.employee.email})]})]})]})]})})]}),D.details&&D.details.length>0&&(0,s.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-5 shadow-sm",children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[(0,s.jsx)(v,{className:"h-5 w-5 text-purple-600 mr-2"}),"Detalles de la Venta"]}),(0,s.jsx)("div",{className:"bg-gray-50 rounded-lg overflow-hidden border border-gray-200",children:(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{className:"bg-gray-100",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Motocicleta"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cantidad"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Precio Unit."}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Descuento"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subtotal"})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:D.details.map((e,t)=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsxs)("div",{children:[(0,s.jsxs)("p",{className:"text-sm font-medium text-gray-900",children:[e.motorcycle.brand," ",e.motorcycle.model]}),(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:[e.motorcycle.year," - ",e.motorcycle.code]}),e.notes&&(0,s.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:e.notes})]})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.quantity}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(0,j.v)(e.unitPrice)}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.discount?(0,j.v)(e.discount):"-"}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:(0,j.v)(e.subtotal)})]},t))})]})})})]}),(0,s.jsx)("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-lg p-6 shadow-sm",children:(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(N,{className:"h-5 w-5 text-green-600 mr-2"}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 font-medium",children:[(null==(c=D.details)?void 0:c.length)||0," item(s) en esta venta"]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("p",{className:"text-sm text-gray-500 mb-1",children:"Total de la Venta"}),(0,s.jsx)("p",{className:"text-2xl sm:text-3xl font-bold text-green-600",children:(0,j.v)(D.total)})]})]})})]})]})})}var A=a(4125);function C(){let[e,t]=(0,l.useState)([]),[a,r]=(0,l.useState)(!0),[h,y]=(0,l.useState)(!1),[p,N]=(0,l.useState)(!1),[v,f]=(0,l.useState)(!1),[b,C]=(0,l.useState)(null),[D,E]=(0,l.useState)(!1);(0,l.useEffect)(()=>{k()},[]);let k=async()=>{try{var e;r(!0);let a=await m.J2.getAll();console.log("Sales API Response:",a.data);let s=Array.isArray(a.data)?a.data:(null==(e=a.data)?void 0:e.data)||[];t(s)}catch(e){console.error("Error fetching sales:",e),t([])}finally{r(!1)}},S=async()=>{if(b){E(!0);try{await m.J2.delete(b.id),await k(),f(!1),C(null)}catch(e){console.error("Error deleting sale:",e)}finally{E(!1)}}},M=[{key:"saleNumber",header:"N\xfamero"},{key:"customer",header:"Cliente",render:e=>(0,s.jsx)("div",{children:(0,s.jsx)("p",{className:"font-medium",children:e.customer?"".concat(e.customer.firstName," ").concat(e.customer.lastName):"-"})})},{key:"employee",header:"Empleado",render:e=>(0,s.jsx)("p",{className:"font-medium",children:e.employee?"".concat(e.employee.firstName," ").concat(e.employee.lastName):"-"})},{key:"saleDate",header:"Fecha",render:e=>(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(n,{className:"h-4 w-4 mr-2 text-gray-400"}),(0,j.Y)(e.saleDate)]})},{key:"total",header:"Total",render:e=>(0,s.jsx)("span",{className:"font-semibold text-green-600",children:(0,j.v)(e.total)})},{key:"status",header:"Estado",render:e=>(0,s.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("COMPLETED"===e.status?"bg-green-100 text-green-800":"PENDING"===e.status?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:e.status})},{key:"actions",header:"Acciones",render:e=>(0,s.jsxs)("div",{className:"flex space-x-1",children:[(0,s.jsx)(u.A,{variant:"ghost",size:"sm",onClick:()=>{C(e),N(!0)},title:"Ver detalles",children:(0,s.jsx)(i,{className:"h-4 w-4 text-blue-500"})}),(0,s.jsx)(u.A,{variant:"ghost",size:"sm",onClick:()=>{C(e),y(!0)},title:"Editar",children:(0,s.jsx)(c.A,{className:"h-4 w-4 text-gray-500"})}),(0,s.jsx)(u.A,{variant:"ghost",size:"sm",onClick:()=>{C(e),f(!0)},title:"Eliminar",children:(0,s.jsx)(d.A,{className:"h-4 w-4 text-red-500"})})]})}];return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Ventas"}),(0,s.jsx)("p",{className:"text-gray-600 mt-2",children:"Registra y consulta las ventas realizadas"})]}),(0,s.jsxs)(u.A,{onClick:()=>{C(null),y(!0)},children:[(0,s.jsx)(o.A,{className:"h-4 w-4 mr-2"}),"Nueva Venta"]})]}),(0,s.jsx)(x.A,{data:e,columns:M,loading:a,emptyMessage:"No hay ventas registradas"}),(0,s.jsx)(g,{isOpen:h,onClose:()=>{y(!1),C(null)},onSuccess:()=>{k()},sale:b}),(0,s.jsx)(w,{isOpen:p,onClose:()=>{N(!1),C(null)},sale:b}),(0,s.jsx)(A.A,{isOpen:v,onClose:()=>{f(!1),C(null)},onConfirm:S,title:"Eliminar Venta",message:"\xbfEst\xe1s seguro de que quieres eliminar esta venta?",itemName:b?"Venta ".concat(b.saleNumber):"",loading:D})]})}}},e=>{e.O(0,[445,139,441,964,358],()=>e(e.s=4816)),_N_E=e.O()}]);